{% extends 'base.html' %}
{% load static helper_tags %}

{% block page_content %}

<div class="row">
	<div class="col">
		<div class="jumbotron">
			<h1 class="display-4">{{category.title}}</h1>
			<hr class="my-4">
			<p class="lead">{{category.description|safe}}</p>
		  </p>
		</div>
	</div>
</div>
<div class="row">
	{% if category.portfolioitem_set.count > 0 %}
		{% for item in category.portfolioitem_set.all %}
		<div class="col-4">
			<div class="card">
				{% with item.gallery.images as images %}

				{% with item.gallery.images.count as image_count %}
				{% if image_count > 1 %}
					<div id="carousel_{{item.pk}}" class="carousel slide" data-ride="carousel" data-interval="false">
						<ol class="carousel-indicators">

						  	{% for image in images %}
						  	{% if forloop.first %}
						      <li data-target="#{{item.pk}}-{{image.pk}}" data-slide-to="{{forloop.counter}}" class="active"></li>
						      {% else %}
						      <li data-target="#{{item.pk}}-{{image.pk}}" data-slide-to="{{forloop.counter}}"></li>
						      {% endif %}
						     {% endfor %}
						    </ol>
						  <div class="carousel-inner">
						  	{% for image in images %}
						  	{% if forloop.first %}
						    <div class="carousel-item active" id="{{item.pk}}-{{image.pk}}">
						      <img class="d-block w-100" src="{{image.image.url}}" alt="{{image.alt}}">

							    {% if image.description %}
							    <div class="carousel-caption d-none d-md-block">
								    <p>{{image.description}}</p>
								 </div>
								 {% endif %}
						    </div>
						    {% else %}
						    <div class="carousel-item">
						      <img class="d-block w-100" src="{{image.image.url}}" alt="{{image.alt}}" id="{{item.pk}}-{{image.pk}}">
						      
							    {% if image.description %}
							    <div class="carousel-caption d-none d-md-block">
								    <p>{{image.description}}</p>
								 </div>
								 {% endif %}
						    </div>
						    {% endif %}
						    {% if image.description %}
						    <div class="carousel-caption d-none d-md-block">
							    <p>{{image.description}}</p>
							 </div>
							 {% endif %}

						    {% endfor %}
						  </div>
						  <a class="carousel-control-prev" href="#carousel_{{item.pk}}" role="button" data-slide="prev">
						    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
						    <span class="sr-only">Previous</span>
						  </a>
						  <a class="carousel-control-next" href="#carousel_{{item.pk}}" role="button" data-slide="next">
						    <span class="carousel-control-next-icon" aria-hidden="true"></span>
						    <span class="sr-only">Next</span>
						  </a>
						</div>
					{% else %}
						<img class="card-img-top" src="{{images.first.image.url}}" alt="{{images.first.alt}}">
					{% endif %}
				{% endwith %}
				{% endwith %}
				<div class="card-body">
					<h5 class="card-title">{{item.title}}</h5>
					<h6 class="card-subtitle mb-2 text-muted">Created: {{item.display_date}}</h6>
					<p class="card-text">{{item.description|safe}}</p>
				</div>
			</div>
		</div>
		{% endfor %}
	{% else %}
	<div class="col alert">
		Looks like I am still loading content for this page. Come back soon!</div>
	{% endif %}
</div>

<div class="row">
	<div class="col">
		<div class="jumbotron" style="margin-top: 25px;">
			<p class="lead">I'd love to create or build something for you! <a href="{% url 'contact' %}">Conact me</a> to get in touch!</p>
		  </p>
		</div>
	</div>
</div>
<script type="text/javascript">
	$('.carousel').carousel();
</script>
{% endblock %}